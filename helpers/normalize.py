import pandas as pd
from sklearn.preprocessing import Normalizer

from features import SYSTEMCALLS, PERMISSIONS

FEATURES = SYSTEMCALLS + PERMISSIONS

for year in range(2010, 2019, 1):
    for quater in [1, 2, 3, 4]:
        # file = f'D:/kronodroid/datasets/subsets_by_EarliestModDate/{year}-Q{quater}.csv'

        file_train = f'D:/kronodroid/datasets/subsets_20_kept/train/{year}-Q{quater}.csv'
        file_test = f'D:/kronodroid/datasets/subsets_20_kept/test/{year}-Q{quater}.csv'

        # data = pd.read_csv(file)

        data_train = pd.read_csv(file_train)
        data_test = pd.read_csv(file_test)

        # data[SYSTEMCALLS] = Normalizer().fit_transform(data[SYSTEMCALLS])
        data_train[SYSTEMCALLS] = Normalizer().fit_transform(data_train[SYSTEMCALLS])
        data_test[SYSTEMCALLS] = Normalizer().fit_transform(data_test[SYSTEMCALLS])

        # data.to_csv(f'D:/kronodroid/datasets/subsets_by_EarliestModDate-Normalized/{year}-Q{quater}.csv', index=False)

        data_train.to_csv(f'D:/kronodroid/datasets/subsets_20_kept-Normalized/train/{year}-Q{quater}.csv', index=False)
        data_test.to_csv(f'D:/kronodroid/datasets/subsets_20_kept-Normalized/test/{year}-Q{quater}.csv', index=False)